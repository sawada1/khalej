<template>
  
  <div>
    <div class="inputs">
        <div class="row">
          <div class="col-12 col-xl-6 col-lg-6 col-md-6">
          <div class="input-custom">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="23"
              height="23"
              viewBox="0 0 23 23"
              fill="none"
            >
              <path
                d="M17.3792 17.5658C17.3797 17.8446 17.4909 18.1117 17.6883 18.3084C17.8858 18.5052 18.1533 18.6155 18.432 18.6151H19.8155C20.0942 18.6155 20.3617 18.5052 20.5592 18.3084C20.7566 18.1117 20.8678 17.8446 20.8684 17.5658V16.9082H17.3792V17.5658Z"
                fill="#A7B9D0"
              />
              <path
                d="M14.9643 14.9785H8.03612C7.94762 14.979 7.86287 15.0143 7.80029 15.0769C7.73771 15.1395 7.70235 15.2242 7.7019 15.3127V16.1895H15.2984V15.3127C15.298 15.2242 15.2626 15.1395 15.2001 15.0769C15.1375 15.0143 15.0527 14.979 14.9643 14.9785Z"
                fill="#A7B9D0"
              />
              <path
                d="M3.33582 11.6403C3.14282 11.4483 2.88213 11.3399 2.60994 11.3384H1.43848V12.0068H3.70236L3.33582 11.6403Z"
                fill="#A7B9D0"
              />
              <path
                d="M19.6644 11.6403L19.2979 12.0068H21.5617V11.3384H20.3903C20.1181 11.3399 19.8574 11.4483 19.6644 11.6403Z"
                fill="#A7B9D0"
              />
              <path
                d="M14.9859 9.20731C15.2924 9.20777 15.5962 9.14922 15.8806 9.03483L18.4499 7.99632L17.336 5.67496C17.1182 5.27108 16.7918 4.93621 16.3936 4.70823C15.9955 4.48024 15.5414 4.36825 15.0829 4.38492H7.91759C7.45906 4.36825 7.00502 4.48024 6.60684 4.70822C6.20866 4.93621 5.88223 5.27108 5.66449 5.67496L4.55054 7.99632L7.12342 9.03847C7.41742 9.37151 14.4378 9.1457 14.9859 9.20731Z"
                fill="#A7B9D0"
              />
              <path
                d="M18.1767 12.1108L19.1577 11.1334C19.3186 10.9701 19.5105 10.8405 19.7222 10.7522C19.9338 10.664 20.161 10.6189 20.3903 10.6196C20.3897 10.6126 21.5764 10.6331 21.5617 10.6124C21.5597 10.2776 21.4776 9.94818 21.3224 9.6516C21.1671 9.35501 20.9431 9.09988 20.6691 8.9075C20.3951 8.71511 20.0791 8.59107 19.7474 8.54572C19.4157 8.50036 19.078 8.53502 18.7624 8.64679L18.0941 8.91627C17.3158 9.19083 15.8197 9.98218 14.9858 9.92602H8.01449C7.18506 9.98329 5.67086 9.18582 4.90614 8.91627L4.23779 8.64678C3.92165 8.53498 3.58333 8.50054 3.25114 8.54633C2.91896 8.59213 2.60258 8.71683 2.32848 8.91C2.05438 9.10317 1.83055 9.35919 1.67571 9.65663C1.52087 9.95407 1.43954 10.2843 1.43851 10.6196L2.60995 10.6196C3.53088 10.5546 4.22803 11.5623 4.82352 12.1109C4.87302 12.1616 4.90654 12.2257 4.91991 12.2953C4.93328 12.3649 4.92593 12.4369 4.89875 12.5023C4.87157 12.5677 4.82577 12.6238 4.76704 12.6634C4.70831 12.7031 4.63922 12.7246 4.56837 12.7253L1.43848 12.7253V15.4851C1.43878 15.6699 1.51161 15.8473 1.6413 15.979C1.77099 16.1107 1.94719 16.1862 2.13201 16.1894H6.98316V15.3126C6.98305 15.1743 7.01021 15.0373 7.06309 14.9095C7.11596 14.7818 7.19351 14.6656 7.29131 14.5679C7.3891 14.4701 7.50521 14.3925 7.633 14.3396C7.76079 14.2868 7.89776 14.2596 8.03605 14.2597H14.9642C15.1025 14.2596 15.2394 14.2868 15.3672 14.3396C15.495 14.3925 15.6111 14.4701 15.7089 14.5679C15.8067 14.6656 15.8843 14.7818 15.9371 14.9095C15.99 15.0373 16.0172 15.1743 16.0171 15.3126V16.1894H20.8682C21.053 16.1862 21.2292 16.1107 21.3589 15.979C21.4886 15.8473 21.5614 15.6699 21.5617 15.4851V12.7253H18.4319C18.361 12.7246 18.2919 12.703 18.2332 12.6634C18.1744 12.6237 18.1287 12.5677 18.1015 12.5023C18.0743 12.4368 18.067 12.3648 18.0803 12.2953C18.0937 12.2257 18.1272 12.1615 18.1767 12.1108ZM14.2707 12.7253H8.72958C8.63542 12.7236 8.54571 12.685 8.47974 12.6178C8.41377 12.5505 8.37681 12.4601 8.37681 12.366C8.37682 12.2718 8.41378 12.1814 8.47976 12.1142C8.54573 12.047 8.63545 12.0084 8.7296 12.0066H14.2707C14.3648 12.0084 14.4545 12.047 14.5205 12.1142C14.5865 12.1814 14.6234 12.2718 14.6234 12.366C14.6234 12.4601 14.5865 12.5506 14.5205 12.6178C14.4545 12.685 14.3648 12.7236 14.2707 12.7253Z"
                fill="#A7B9D0"
              />
              <path
                d="M2.13208 17.5658C2.13262 17.8446 2.24384 18.1117 2.44128 18.3084C2.63872 18.5052 2.90623 18.6155 3.18498 18.6151H4.56844C4.84718 18.6155 5.11468 18.5052 5.31212 18.3084C5.50956 18.1117 5.62077 17.8446 5.6213 17.5658V16.9082H2.13208V17.5658Z"
                fill="#A7B9D0"
              />
            </svg>
            <Dropdown
              :filter-placeholder="$t('search')"
              v-model="car_id"
              v-bind="car_idAttrs"
              :options="cars"
              filter
              optionLabel="name"
              optionValue="id"
              :placeholder="$t('carName')"
              class=""
            >
              <template #option="slotProps">
                <div class="flex align-items-center">
                  <div @click="price = slotProps.option.price">
                    {{ slotProps.option.name }}
                  </div>
                </div>
              </template>
            </Dropdown>
           
          </div>
          <div class="text-danger">{{ errors.car_id }}</div>
          <div class="text-danger" v-if="errorsApi">
            {{ errorsApi.car_id ? errorsApi.car_id[0] : "" }}
          </div>
        </div>
        <div class="col-12 col-xl-6 col-lg-6 col-md-6">
          <div class="input-custom">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
            >
              <path
                d="M14.1667 2.91675H5.83341C3.33341 2.91675 1.66675 4.16675 1.66675 7.08342V12.9167C1.66675 15.8334 3.33341 17.0834 5.83341 17.0834H14.1667C16.6667 17.0834 18.3334 15.8334 18.3334 12.9167V7.08342C18.3334 4.16675 16.6667 2.91675 14.1667 2.91675ZM6.66675 14.7917H4.16675C3.82508 14.7917 3.54175 14.5084 3.54175 14.1667C3.54175 13.8251 3.82508 13.5417 4.16675 13.5417H6.66675C7.00841 13.5417 7.29175 13.8251 7.29175 14.1667C7.29175 14.5084 7.00841 14.7917 6.66675 14.7917ZM10.0001 12.5001C8.61675 12.5001 7.50008 11.3834 7.50008 10.0001C7.50008 8.61675 8.61675 7.50008 10.0001 7.50008C11.3834 7.50008 12.5001 8.61675 12.5001 10.0001C12.5001 11.3834 11.3834 12.5001 10.0001 12.5001ZM15.8334 6.45841H13.3334C12.9917 6.45841 12.7084 6.17508 12.7084 5.83341C12.7084 5.49175 12.9917 5.20841 13.3334 5.20841H15.8334C16.1751 5.20841 16.4584 5.49175 16.4584 5.83341C16.4584 6.17508 16.1751 6.45841 15.8334 6.45841Z"
                fill="#A7B9D0"
              />
            </svg>
            <input
              type="number"
              v-model="price"
              v-bind="priceAttrs"
              readonly
              :placeholder="$t('price')"
            />
            <!-- <div class="label-container">
            </div> -->
          </div>
          <div class="text-danger">{{ errors.price }}</div>
          <div class="text-danger" v-if="errorsApi">
            {{ errorsApi.price ? errorsApi.price[0] : "" }}
          </div>
        </div>
        <div class="col-12 col-xl-6 col-lg-6 col-md-6">
          <div class="input-custom">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="21"
              viewBox="0 0 20 21"
              fill="none"
            >
              <path
                d="M15 2.00604H5C3.61667 2.00604 2.5 3.11438 2.5 4.48104V13.5727C2.5 14.9394 3.61667 16.056 5 16.056H5.63333C6.29167 16.056 6.93333 16.3144 7.4 16.781L8.825 18.1894C9.475 18.831 10.525 18.831 11.175 18.1894L12.6 16.781C13.0667 16.3144 13.7083 16.056 14.3667 16.056H15C16.3833 16.056 17.5 14.9394 17.5 13.5727V4.48104C17.5 3.11438 16.3833 2.00604 15 2.00604ZM10 4.96438C10.9 4.96438 11.625 5.69771 11.625 6.58938C11.625 7.47271 10.925 8.18104 10.0583 8.21438C10.025 8.21438 9.975 8.21438 9.93333 8.21438C9.05833 8.18104 8.36667 7.47271 8.36667 6.58938C8.375 5.69771 9.1 4.96438 10 4.96438ZM12.2917 12.581C11.0333 13.4227 8.96667 13.4227 7.70833 12.581C6.6 11.8477 6.6 10.631 7.70833 9.88938C8.975 9.04771 11.0417 9.04771 12.2917 9.88938C13.4 10.631 13.4 11.8394 12.2917 12.581Z"
                fill="#A7B9D0"
              />
            </svg>
            <div class="label-container">
              <label for="">{{ $t("enterName") }} </label>
              <input
                type="text"
                v-model="name"
                v-bind="nameAttrs"
                :placeholder="$t('name')"
              />
            </div>
          </div>
          <div class="text-danger">{{ errors.name }}</div>
          <div class="text-danger" v-if="errorsApi">
            {{ errorsApi.name ? errorsApi.name[0] : "" }}
          </div>
        </div>
        <div class="col-12 col-xl-6 col-lg-6 col-md-6">
          <div class="input-custom">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
            >
              <path
                d="M9.20841 12.4584L7.66675 14.0001C7.34175 14.3251 6.82508 14.3251 6.49175 14.0084C6.40008 13.9167 6.30841 13.8334 6.21675 13.7417C5.35841 12.8751 4.58341 11.9667 3.89175 11.0167C3.20841 10.0667 2.65841 9.11675 2.25841 8.17508C1.86675 7.22508 1.66675 6.31675 1.66675 5.45008C1.66675 4.88341 1.76675 4.34175 1.96675 3.84175C2.16675 3.33341 2.48341 2.86675 2.92508 2.45008C3.45841 1.92508 4.04175 1.66675 4.65841 1.66675C4.89175 1.66675 5.12508 1.71675 5.33341 1.81675C5.55008 1.91675 5.74175 2.06675 5.89175 2.28341L7.82508 5.00841C7.97508 5.21675 8.08341 5.40841 8.15841 5.59175C8.23341 5.76675 8.27508 5.94175 8.27508 6.10008C8.27508 6.30008 8.21675 6.50008 8.10008 6.69175C7.99175 6.88341 7.83341 7.08341 7.63341 7.28341L7.00008 7.94175C6.90841 8.03341 6.86675 8.14175 6.86675 8.27508C6.86675 8.34175 6.87508 8.40008 6.89175 8.46675C6.91675 8.53341 6.94175 8.58341 6.95842 8.63341C7.10842 8.90841 7.36675 9.26675 7.73341 9.70008C8.10841 10.1334 8.50841 10.5751 8.94175 11.0167C9.02508 11.1001 9.11675 11.1834 9.20008 11.2667C9.53341 11.5917 9.54175 12.1251 9.20841 12.4584Z"
                fill="#A7B9D0"
              />
              <path
                d="M18.3083 15.275C18.3083 15.5083 18.2667 15.75 18.1833 15.9833C18.1583 16.05 18.1333 16.1166 18.1 16.1833C17.9583 16.4833 17.775 16.7666 17.5333 17.0333C17.125 17.4833 16.675 17.8083 16.1667 18.0166C16.1583 18.0166 16.15 18.025 16.1417 18.025C15.65 18.225 15.1167 18.3333 14.5417 18.3333C13.6917 18.3333 12.7833 18.1333 11.825 17.725C10.8667 17.3166 9.90833 16.7666 8.95833 16.075C8.63333 15.8333 8.30833 15.5916 8 15.3333L10.725 12.6083C10.9583 12.7833 11.1667 12.9166 11.3417 13.0083C11.3833 13.025 11.4333 13.05 11.4917 13.075C11.5583 13.1 11.625 13.1083 11.7 13.1083C11.8417 13.1083 11.95 13.0583 12.0417 12.9666L12.675 12.3416C12.8833 12.1333 13.0833 11.975 13.275 11.875C13.4667 11.7583 13.6583 11.7 13.8667 11.7C14.025 11.7 14.1917 11.7333 14.375 11.8083C14.5583 11.8833 14.75 11.9916 14.9583 12.1333L17.7167 14.0916C17.9333 14.2416 18.0833 14.4166 18.175 14.625C18.2583 14.8333 18.3083 15.0416 18.3083 15.275Z"
                fill="#A7B9D0"
              />
            </svg>
            <div class="label-container">
              <label for=""> {{ $t("enterPhone") }} </label>
              <input
                type="tel"
                v-model="phone"
                name="phone"
                maxlength="10"
                v-bind="phoneAttrs"
                :placeholder="$t('phone')"
              />
            </div>
            <div class="num">966+</div>
          </div>
          <div class="text-danger">{{ errors.phone }}</div>
          <div class="text-danger" v-if="errorsApi">
            {{ errorsApi.phone ? errorsApi.phone[0] : "" }}
          </div>
        </div>
        </div>
      </div>
      <button @click="onSubmit()" :disabled="pending" class="send-btn gap-4">
      {{ $t("send") }}
      <v-progress-circular
        v-if="pending"
        indeterminate
        :size="30"
        :width="4"
      ></v-progress-circular>
    </button>
  </div>

</template>


<script setup>
import { useindividualsStore } from "@/stores/individuals";
let store = useindividualsStore();
// import "mosha-vue-toastify/dist/style.css";
import { useForm } from "vee-validate";
import * as yup from "yup";
let years = ref([1, 2, 3, 4, 5, 6]);
let errorsApi = ref();
const props = defineProps(["cars"]);
const { locale } = useI18n();
const { errors, handleSubmit, values, resetForm, defineField } = useForm({
  validationSchema: yup.object({
    phone: yup.string().required(locale.value == 'ar' ? 'هذا الحقل مطلوب' : 'this field is required'),
    name: yup.string().required(locale.value == 'ar' ? 'هذا الحقل مطلوب' : 'this field is required'),
    price: yup.string().required(locale.value == 'ar' ? 'هذا الحقل مطلوب' : 'this field is required'),
    car_id: yup.string().required(locale.value == 'ar' ? 'هذا الحقل مطلوب' : 'this field is required'),
  }),
});
let pending = ref(store.isLoading2);
const [car_id, car_idAttrs] = defineField("car_id");
const [name, nameAttrs] = defineField("name");
const [price, priceAttrs] = defineField("price");
const [phone, phoneAttrs] = defineField("phone");

const onSubmit = handleSubmit(() => {
  store.getContact2(values, resetForm);
});

watch(
  [() => store.isLoading2, () => store.errors2],
  ([val1, val2]) => {
    pending.value = val1;
    errorsApi.value = val2;
  }
);
</script>